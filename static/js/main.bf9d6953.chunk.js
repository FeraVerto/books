(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{19:function(e,t,o){e.exports={App:"App_App__16ZpL",main:"App_main__3ZkGI",create_position:"App_create_position__367Uh","App-logo":"App_App-logo__25k4o","App-logo-spin":"App_App-logo-spin__1e7sv",App_header:"App_App_header__1WhCC"}},20:function(e,t,o){e.exports={book_list:"BookList_book_list__3m2QI",book_item_link:"BookList_book_item_link__3cqyY",book_item:"BookList_book_item__2BIC2",book_item_image:"BookList_book_item_image__2s3Vc"}},31:function(e,t,o){e.exports={button:"Button_button__1Y5Fm"}},32:function(e,t,o){e.exports={input:"Input_input__308IJ"}},33:function(e,t,o){e.exports={search:"Search_search__2YEIt",button:"Search_button__2nzbD"}},36:function(e,t,o){e.exports={input_image:"FormField_input_image__2jhd_",image_block:"FormField_image_block__1kg7K",image:"FormField_image__3uMbO"}},37:function(e,t,o){e.exports={form:"CreateBook_form__19dYL"}},38:function(e,t,o){e.exports={form:"EditBook_form__1EE08"}},45:function(e,t,o){},51:function(e,t,o){"use strict";o.r(t);var n=o(0),c=o.n(n),a=o(30),i=o.n(a),r=(o(45),o(10)),s=o(39),b=o(5),l=o(2),u=o(19),j=o.n(u),p=o(11),d=o(20),h=o.n(d),_=o(31),m=o.n(_),O=o(1),f=function(e){var t=e.type,o=e.text,n=e.onClick;return Object(O.jsx)("button",{className:m.a.button,type:t,onClick:n,children:o})},x=o(40),k=o(32),g=o.n(k),v=function(e){var t=e.className,o=e.id,n=e.onChange,c=e.value,a=e.type,i=e.name,r=Object(x.a)(e,["className","id","onChange","value","type","name"]);return Object(O.jsx)("input",Object(b.a)({type:a,className:"".concat(g.a.input," ").concat(t),id:o,onChange:n,value:c,name:i},r))},S=o(33),y=o.n(S),C=o(15),F=function(){for(var e=[],t=0,o=Object.keys(localStorage);t<o.length;t++){var n=o[t],c=localStorage.getItem(n);null!==c&&e.push({id:n,book:JSON.parse(c)})}return e},A=function(e){var t=e.dispatch,o=(e.state,Object(n.useState)()),c=Object(r.a)(o,2),a=c[0],i=c[1],s=Object(C.a)({initialValues:{search:""},onSubmit:function(e){t({type:"SET_BOOKS_LIST",payload:a}),t({type:"SEARCH_FILTER",payload:{filter:e.search}})}});return Object(n.useEffect)((function(){i(F())}),[]),Object(O.jsxs)("form",{onSubmit:s.handleSubmit,className:y.a.search,children:[Object(O.jsx)(v,{id:"search",name:"search",onChange:s.handleChange,value:s.values.search,type:"search"}),Object(O.jsx)(f,{text:"Search",type:"submit"})]})},L=function(e){var t=e.state,o=e.dispatch;return Object(n.useEffect)((function(){o({type:"SET_BOOKS_LIST",payload:F()})}),[]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(A,{state:t,dispatch:o}),Object(O.jsx)("ul",{className:h.a.book_list,children:t.books.map((function(e){return Object(O.jsx)(p.b,{className:h.a.book_item_link,to:"/edit/".concat(e.id),children:Object(O.jsxs)("li",{className:h.a.book_item,children:[Object(O.jsxs)("span",{children:["Author: ",e.book.author?e.book.author:"unknown"]}),Object(O.jsx)("span",{children:e.book.title}),Object(O.jsx)("div",{className:h.a.book_item_image,children:Object(O.jsx)("img",{alt:e.book.title,src:e.book.cover})})]})},e.id)}))})]})},N=o(53),E=o(36),I=o.n(E),B=function(e){var t=e.formik,o=e.title,n=e.author;e.cover;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("label",{htmlFor:"title",children:o}),Object(O.jsx)(v,Object(b.a)({id:"title",type:"text"},t.getFieldProps("title"))),Object(O.jsx)("label",{htmlFor:"author",children:n}),Object(O.jsx)(v,Object(b.a)({id:"author",type:"text"},t.getFieldProps("author"))),Object(O.jsx)(v,{className:I.a.input_image,id:"cover",type:"file",name:"cover",onBlur:t.handleBlur,onChange:function(e){var o=e.target;t.setFieldValue("cover",o.files[0])}})]})},w=function(e){return new Promise((function(t,o){var n=new FileReader;n.onload=function(){return t(n.result)},n.onerror=function(e){return o(e)},e.type&&e.type.match("image.*")&&(console.log("file",e),n.readAsDataURL(e))}))},T=o(37),R=o.n(T),J=function(){var e=Object(n.useState)(""),t=Object(r.a)(e,2),o=t[0],c=t[1],a=Object(C.a)({initialValues:{title:"",author:"",cover:{}},onSubmit:function(e){w(e.cover).then((function(t){e=Object(b.a)(Object(b.a)({},e),{},{cover:t}),c(JSON.stringify(e))}))}});return Object(n.useEffect)((function(){var e=Object(N.a)();o&&localStorage.setItem(e,o)})),Object(O.jsxs)("form",{className:R.a.form,onSubmit:a.handleSubmit,children:[Object(O.jsx)("h2",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043a\u043d\u0438\u0433\u0443"}),Object(O.jsx)(B,{formik:a,title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u0438\u0433\u0438",author:"\u0418\u043c\u044f \u0430\u0432\u0442\u043e\u0440\u0430"}),Object(O.jsx)(f,{type:"submit",text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})},M=o(38),P=o.n(M),V=function(e){var t=e.state,o=(e.dispatch,e.editMode),c=e.setEditMode,a=Object(l.f)().id,i=Object(n.useState)(""),s=Object(r.a)(i,2),u=s[0],j=s[1],p=Object(n.useState)(""),d=Object(r.a)(p,2),h=d[0],_=d[1],m=Object(C.a)({initialValues:{title:"",author:"",cover:{}},onSubmit:function(e){w(e.cover).then((function(t){e=Object(b.a)(Object(b.a)({},e),{},{cover:t}),j(JSON.stringify(e)),c(!0)}))}});return Object(n.useEffect)((function(){u&&localStorage.setItem(a,u),h&&localStorage.removeItem(h),c(!1)})),o?Object(O.jsx)(l.a,{to:"/"}):Object(O.jsx)("div",{className:P.a.form,children:t.books.map((function(e){return e.id===a&&Object(O.jsxs)("form",{onSubmit:m.handleSubmit,children:[Object(O.jsx)(B,{formik:m,title:e.book.title,author:e.book.author}),Object(O.jsx)(f,{type:"submit",text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){!function(e){_(e)}(e.id),c(!0)}}),Object(O.jsx)(f,{type:"submit",text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]},e.id)}))})},K=function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(p.b,{to:"/",children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043d\u0438\u0433"}),Object(O.jsx)(p.b,{to:"/create",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043d\u0438\u0433\u0443"})]})},Y={books:[]},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BOOKS_LIST":return Object(b.a)(Object(b.a)({},e),{},{books:Object(s.a)(t.payload)});case"SEARCH_FILTER":return console.log("state",e),Object(b.a)(Object(b.a)({},e),{},{books:e.books.filter((function(e){return e.book.title.toLowerCase().includes(t.payload.filter.toLowerCase())||e.book.author.toLowerCase().includes(t.payload.filter.toLowerCase())}))});default:return e}},H=function(){var e=Object(n.useReducer)(D,Y),t=Object(r.a)(e,2),o=t[0],c=t[1],a=Object(n.useState)(!1),i=Object(r.a)(a,2),s=i[0],b=i[1];return Object(O.jsxs)("div",{className:j.a.App,children:[Object(O.jsx)("header",{className:j.a.App_header,children:Object(O.jsx)(K,{})}),Object(O.jsx)("main",{className:j.a.main,children:Object(O.jsxs)("div",{className:j.a.create_position,children:[Object(O.jsx)("h1",{children:"List of Books"}),Object(O.jsx)(l.b,{exact:!0,path:"/",render:function(){return Object(O.jsx)(L,{state:o,dispatch:c})}}),Object(O.jsx)(l.b,{path:"/create",render:function(){return Object(O.jsx)(J,{})}}),Object(O.jsx)(l.b,{path:"/edit/:id",render:function(){return Object(O.jsx)(V,{state:o,dispatch:c,editMode:s,setEditMode:b})}})]})})]})},U=function(e){e&&e instanceof Function&&o.e(3).then(o.bind(null,54)).then((function(t){var o=t.getCLS,n=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;o(e),n(e),c(e),a(e),i(e)}))};i.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(p.a,{children:Object(O.jsx)(H,{})})}),document.getElementById("root")),U()}},[[51,1,2]]]);
//# sourceMappingURL=main.bf9d6953.chunk.js.map