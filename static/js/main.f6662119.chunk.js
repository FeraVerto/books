(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{24:function(t,e,n){t.exports={App:"App_App__16ZpL","App-logo":"App_App-logo__25k4o","App-logo-spin":"App_App-logo-spin__1e7sv",App_header:"App_App_header__1WhCC"}},37:function(t,e,n){},43:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),i=n(29),o=n.n(i),a=(n(37),n(13)),s=n(32),j=n(8),u=n(2),b=n(24),l=n.n(b),d=n(10),O=n(1),p=function(t){var e=t.state,n=t.dispatch;return Object(c.useEffect)((function(){for(var t=[],e=0,c=Object.keys(localStorage);e<c.length;e++){var r=c[e],i=localStorage.getItem(r);null!==i&&t.push({id:r,book:JSON.parse(i)})}n({type:"SET_BOOKS_LIST",payload:t})}),[]),Object(O.jsx)("ul",{children:e.books.map((function(t){return Object(O.jsx)(d.b,{to:"/edit/".concat(t.id),children:Object(O.jsxs)("li",{children:[Object(O.jsx)("span",{children:t.book.title}),Object(O.jsx)("span",{children:t.book.author}),Object(O.jsx)("img",{width:170,height:200,src:t.book.cover})]})},t.id)}))})},h=n(21),f=n(45),x=function(t){var e=t.formik,n=t.title,c=t.author;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("label",{htmlFor:"title",children:n}),Object(O.jsx)("input",Object(j.a)({id:"title",type:"text"},e.getFieldProps("title"))),Object(O.jsx)("label",{htmlFor:"author",children:c}),Object(O.jsx)("input",Object(j.a)({id:"author",type:"text"},e.getFieldProps("author"))),Object(O.jsx)("input",{id:"cover",type:"file",name:"cover",onBlur:e.handleBlur,value:e.values.name,onChange:function(t){e.setFieldValue("cover",t.target.files[0])}})]})},m=function(t){return new Promise((function(e,n){var c=new FileReader;c.onload=function(){return e(c.result)},c.onerror=function(t){return n(t)},t&&t.type.match("image.*")&&c.readAsDataURL(t)}))},v=function(){var t=Object(c.useState)(""),e=Object(a.a)(t,2),n=e[0],r=e[1],i=Object(h.a)({initialValues:{title:"",author:"",cover:{}},onSubmit:function(t){m(t.cover).then((function(e){t=Object(j.a)(Object(j.a)({},t),{},{cover:e}),r(JSON.stringify(t))}))}});return Object(c.useEffect)((function(){var t=Object(f.a)();n&&localStorage.setItem(t,n)})),Object(O.jsxs)("form",{onSubmit:i.handleSubmit,children:[Object(O.jsx)(x,{formik:i,title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u0438\u0433\u0438",author:"\u0418\u043c\u044f \u0430\u0432\u0442\u043e\u0440\u0430"}),Object(O.jsx)("button",{type:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})},g=function(t){var e=t.state,n=(t.dispatch,Object(u.e)().id),r=Object(c.useState)(!1),i=Object(a.a)(r,2),o=i[0],s=(i[1],Object(c.useState)("")),b=Object(a.a)(s,2),l=b[0],d=b[1],p=Object(c.useState)(""),f=Object(a.a)(p,2),v=f[0],g=f[1],S=Object(h.a)({initialValues:{title:"",author:"",cover:{}},onSubmit:function(t){m(t.cover).then((function(e){t=Object(j.a)(Object(j.a)({},t),{},{cover:e}),d(JSON.stringify(t))}))}});return Object(c.useEffect)((function(){l&&localStorage.setItem(n,l),v&&localStorage.removeItem(v)})),Object(O.jsx)("div",{children:!o&&Object(O.jsx)("div",{children:e.books.map((function(t){return t.id===n&&Object(O.jsxs)("form",{onSubmit:S.handleSubmit,children:[Object(O.jsx)(x,{formik:S,title:t.book.title,author:t.book.author}),Object(O.jsx)("button",{type:"submit",onClick:function(){return function(t){g(t)}(t.id)},children:"Delete"}),Object(O.jsx)("button",{type:"submit",children:"Save"})]},t.id)}))})})},S=function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(d.b,{to:"/",children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043d\u0438\u0433"}),Object(O.jsx)(d.b,{to:"/create",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043d\u0438\u0433\u0443"})]})},_={books:[]},k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_BOOKS_LIST":return Object(j.a)(Object(j.a)({},t),{},{books:Object(s.a)(e.payload)});default:return t}},y=function(){var t=Object(c.useReducer)(k,_),e=Object(a.a)(t,2),n=e[0],r=e[1];return Object(O.jsxs)("div",{className:l.a.App,children:[Object(O.jsx)("header",{className:l.a.App_header,children:Object(O.jsx)(S,{})}),Object(O.jsxs)("main",{children:[Object(O.jsx)(u.a,{exact:!0,path:"/",render:function(){return Object(O.jsx)(p,{state:n,dispatch:r})}}),Object(O.jsx)(u.a,{path:"/create",render:function(){return Object(O.jsx)(v,{})}}),Object(O.jsx)(u.a,{path:"/edit/:id",render:function(){return Object(O.jsx)(g,{state:n,dispatch:r})}})]})]})},A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),c(t),r(t),i(t),o(t)}))};o.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(d.a,{children:Object(O.jsx)(y,{})})}),document.getElementById("root")),A()}},[[43,1,2]]]);
//# sourceMappingURL=main.f6662119.chunk.js.map